# å‰‘æŒ‡Offer07. é‡å»ºäºŒå‰æ ‘ï¼ˆå¤ªéš¾äº†ï¼‰
--------------------------------------------------------------------------------
# ä¸€ã€é¢˜ç›®
è¾“å…¥æŸäºŒå‰æ ‘çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœï¼Œè¯·é‡å»ºè¯¥äºŒå‰æ ‘ã€‚å‡è®¾è¾“å…¥çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœä¸­éƒ½ä¸å«é‡å¤çš„æ•°å­—ã€‚


```
å‰åºéå† preorder = [3,9,20,15,7]
ä¸­åºéå† inorder = [9,3,15,20,7]
è¿”å›å¦‚ä¸‹çš„äºŒå‰æ ‘ï¼š

    3
   / \
  9  20
    /  \
   15   7
```



# äºŒã€è§£é¢˜æ–¹æ³•

## é€’å½’æ³•
### 1ã€è§£é¢˜æ€è·¯ï¼š
#### é¢˜ç›®åˆ†æï¼š
> å‰åºéå†ç‰¹ç‚¹ï¼š èŠ‚ç‚¹æŒ‰ç…§ [ æ ¹èŠ‚ç‚¹ | å·¦å­æ ‘ | å³å­æ ‘ ] æ’åºï¼Œä»¥é¢˜ç›®ç¤ºä¾‹ä¸ºä¾‹ï¼š[ 3 | 9 | 20 15 7 ]
>
> ä¸­åºéå†ç‰¹ç‚¹ï¼š èŠ‚ç‚¹æŒ‰ç…§ [ å·¦å­æ ‘ | æ ¹èŠ‚ç‚¹ | å³å­æ ‘ ] æ’åºï¼Œä»¥é¢˜ç›®ç¤ºä¾‹ä¸ºä¾‹ï¼š[ 9 | 3 | 15 20 7 ]
>
> æ ¹æ®é¢˜ç›®æè¿°è¾“å…¥çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœä¸­éƒ½ä¸å«é‡å¤çš„æ•°å­—ï¼Œå…¶è¡¨æ˜æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚

- æ ¹æ®ä»¥ä¸Šç‰¹ç‚¹ï¼Œå¯ä»¥æŒ‰é¡ºåºå®Œæˆä»¥ä¸‹å·¥ä½œï¼š
  - å‰åºéå†çš„é¦–ä¸ªå…ƒç´ å³ä¸ºæ ¹èŠ‚ç‚¹ root çš„å€¼ï¼›
  - åœ¨ä¸­åºéå†ä¸­æœç´¢æ ¹èŠ‚ç‚¹ root çš„ç´¢å¼• ï¼Œå¯å°†ä¸­åºéå†åˆ’åˆ†ä¸º [ å·¦å­æ ‘ | æ ¹èŠ‚ç‚¹ | å³å­æ ‘ ] ã€‚
  - æ ¹æ®ä¸­åºéå†ä¸­çš„å·¦ï¼ˆå³ï¼‰å­æ ‘çš„èŠ‚ç‚¹æ•°é‡ï¼Œå¯å°†å‰åºéå†åˆ’åˆ†ä¸º [ æ ¹èŠ‚ç‚¹ | å·¦å­æ ‘ | å³å­æ ‘ ] ã€‚
- è‡ªæ­¤å¯ç¡®å®š ä¸‰ä¸ªèŠ‚ç‚¹çš„å…³ç³» ï¼š1.æ ‘çš„æ ¹èŠ‚ç‚¹ã€2.å·¦å­æ ‘æ ¹èŠ‚ç‚¹ã€3.å³å­æ ‘æ ¹èŠ‚ç‚¹ï¼ˆå³å‰åºéå†ä¸­å·¦ï¼ˆå³ï¼‰å­æ ‘çš„é¦–ä¸ªå…ƒç´ ï¼‰ã€‚

> å­æ ‘ç‰¹ç‚¹ï¼š å­æ ‘çš„å‰åºå’Œä¸­åºéå†ä»ç¬¦åˆä»¥ä¸Šç‰¹ç‚¹ï¼Œä»¥é¢˜ç›®ç¤ºä¾‹çš„å³å­æ ‘ä¸ºä¾‹ï¼šå‰åºéå†ï¼š[20 | 15 | 7]ï¼Œä¸­åºéå† [ 15 | 20 | 7 ] ã€‚
>

- æ ¹æ®å­æ ‘ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŒæ ·çš„æ–¹æ³•å¯¹å·¦ï¼ˆå³ï¼‰å­æ ‘è¿›è¡Œåˆ’åˆ†ï¼Œ**æ¯è½®å¯ç¡®è®¤ä¸‰ä¸ªèŠ‚ç‚¹çš„å…³ç³»** ã€‚æ­¤é€’æ¨æ€§è´¨è®©æˆ‘ä»¬è”æƒ³åˆ°ç”¨ é€’å½’æ–¹æ³• å¤„ç†ã€‚


## 2ã€é€’å½’è§£æï¼š
- é€’æ¨å‚æ•°ï¼š å‰åºéå†ä¸­æ ¹èŠ‚ç‚¹çš„ç´¢å¼•pre_rootã€ä¸­åºéå†å·¦è¾¹ç•Œin_leftã€ä¸­åºéå†å³è¾¹ç•Œin_rightã€‚
- ç»ˆæ­¢æ¡ä»¶ï¼š å½“ `in_left > in_right `ï¼Œå­æ ‘ä¸­åºéå†ä¸ºç©ºï¼Œè¯´æ˜å·²ç»è¶Šè¿‡å¶å­èŠ‚ç‚¹ï¼Œæ­¤æ—¶è¿”å› nullnull ã€‚
- é€’æ¨å·¥ä½œï¼š
  - å»ºç«‹æ ¹èŠ‚ç‚¹rootï¼š å€¼ä¸ºå‰åºéå†ä¸­ç´¢å¼•ä¸ºpre_rootçš„èŠ‚ç‚¹å€¼ã€‚
  - æœç´¢æ ¹èŠ‚ç‚¹rootåœ¨ä¸­åºéå†çš„ç´¢å¼•iï¼š ä¸ºäº†æå‡æœç´¢æ•ˆç‡ï¼Œæœ¬é¢˜è§£ä½¿ç”¨å“ˆå¸Œè¡¨ dic é¢„å­˜å‚¨ä¸­åºéå†çš„å€¼ä¸ç´¢å¼•çš„æ˜ å°„å…³ç³»ï¼Œæ¯æ¬¡æœç´¢çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)O(1)ã€‚
  - æ„å»ºæ ¹èŠ‚ç‚¹rootçš„å·¦å­æ ‘å’Œå³å­æ ‘ï¼š é€šè¿‡è°ƒç”¨ recur() æ–¹æ³•å¼€å¯ä¸‹ä¸€å±‚é€’å½’ã€‚
    - å·¦å­æ ‘ï¼š æ ¹èŠ‚ç‚¹ç´¢å¼•ä¸º pre_root + 1 ï¼Œä¸­åºéå†çš„å·¦å³è¾¹ç•Œåˆ†åˆ«ä¸º in_left å’Œ i - 1ã€‚
    - å³å­æ ‘ï¼š æ ¹èŠ‚ç‚¹ç´¢å¼•ä¸º i - in_left + pre_root + 1ï¼ˆå³ï¼šæ ¹èŠ‚ç‚¹ç´¢å¼• + å·¦å­æ ‘é•¿åº¦ + 1ï¼‰ï¼Œä¸­åºéå†çš„å·¦å³è¾¹ç•Œåˆ†åˆ«ä¸º i + 1 å’Œ in_rightã€‚
- è¿”å›å€¼ï¼š è¿”å› rootï¼Œå«ä¹‰æ˜¯å½“å‰é€’å½’å±‚çº§å»ºç«‹çš„æ ¹èŠ‚ç‚¹ root ä¸ºä¸Šä¸€é€’å½’å±‚çº§çš„æ ¹èŠ‚ç‚¹çš„å·¦æˆ–å³å­èŠ‚ç‚¹ã€‚

## 3ã€ä»£ç å®ç°

```java
class Solution {
    HashMap<Integer, Integer> dic = new HashMap<>();
    int[] po;
    public TreeNode buildTree(int[] preorder, int[] inorder) {
        po = preorder;
        for(int i = 0; i < inorder.length; i++) 
            dic.put(inorder[i], i);
        return recur(0, 0, inorder.length - 1);
    }
    TreeNode recur(int pre_root, int in_left, int in_right) {
        if(in_left > in_right) return null;
        TreeNode root = new TreeNode(po[pre_root]);
        int i = dic.get(po[pre_root]);
        root.left = recur(pre_root + 1, in_left, i - 1);
        root.right = recur(pre_root + i - in_left + 1, i + 1, in_right);
        return root;
    }
}
```





å‚è€ƒï¼š

[äºŒå‰æ ‘çš„é¢˜ï¼Œå°±é‚£å‡ ä¸ªæ¡†æ¶ï¼Œæ¯ç‡¥è‡³æğŸ¤”](https://mp.weixin.qq.com/s?__biz=MzAxODQxMDM0Mw==&mid=2247485871&idx=1&sn=bcb24ea8927995b585629a8b9caeed01&chksm=9bd7f7a7aca07eb1b4c330382a4e0b916ef5a82ca48db28908ab16563e28a376b5ca6805bec2&scene=126&sessionid=1595593405&key=f4e53e261e827f63474723697083aca80eb0077fe96ab2f8ca253b74920f0fedad27a3c0c46acf52cdfd1e9c77f95b98b4b9944dec5266fff25ab248b5b89fb24d83ef58d86fbabfa4a7ebb501354b0a&ascene=1&uin=MTg5MjE1NTkyOQ%3D%3D&devicetype=Windows+10+x64&version=62090529&lang=zh_CN&exportkey=A8Aq14DOnHbQQzZ4HXsCaVc%3D&pass_ticket=Q%2FyOxI8Rq%2FVwxMo%2BsOtF0O0p8bsOvb6GlOHSBlCiv0whfNKUcodneQssut9qWY11)